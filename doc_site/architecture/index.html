<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Architecture - Suited.js Documentation</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Architecture";
    var mkdocs_page_input_path = "architecture.md";
    var mkdocs_page_url = "/architecture/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Suited.js Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">Architecture</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#architecture">Architecture</a></li>
                
                    <li><a class="toctree-l4" href="#overview">Overview</a></li>
                
                    <li><a class="toctree-l4" href="#events">Events</a></li>
                
                    <li><a class="toctree-l4" href="#lifecycle-events">Lifecycle Events</a></li>
                
                    <li><a class="toctree-l4" href="#runtime-events">Runtime Events</a></li>
                
                    <li><a class="toctree-l4" href="#plugins">Plugins</a></li>
                
            
            </ul>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Suited.js Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Architecture</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <!--
@Author: Roberts Karl <robertk>
@Date:   2016-Aug-07
@Project: suited
@Last modified by:   robertk
@Last modified time: 2016-Aug-15
@License: Copyright 2016 Karl Roberts <karl.roberts@owtelse.com> and Dirk van Rensburg <dirk.van.rensburg@gmail.com>

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

-->

<h1 id="architecture">Architecture</h1>
<h3 id="overview">Overview</h3>
<p>This document provides an architectural overview of Suited. It describes the different components that make up Suited and references more detailed descriptions where necessary. Suited is loaded from <code>core.js</code>, which is responsible for catching and distributing browser events as well as loading and interpreting the configuration.</p>
<p>While <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/suited.js"><code>suited</code></a> is mostly event based some state is managed in a <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/state.js"><code>State</code></a> object that <code>suited</code> maintains.</p>
<h3 id="events">Events</h3>
<p>Suited is event based. All browser events are mapped into suited events. All event handling is done by plugins, which are registered with the  <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/dispatch.js"><code>dispatch</code></a> object when loaded.</p>
<p>The <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/dispatch.js"><code>dispatch</code></a> sends events to all plugins that have registered a callback for that event. <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugin.js"><code>Plugin</code>'s</a> can also fire events for others to consume.</p>
<p>The framework generates some lifecycle events and there are some core runtime events related to default features such as changing Mode or slide. Lifecycle events are useful if you want your plugin to run some code or tranform the document after other transformations have run, for instance the Markdown plugin listens to the <code>PluginsLoaded</code> event and then walks the document transforming markdown into html, it wants the other plugins to be loaded as they may introduce extra dom elements that need to be taken into account.</p>
<h3 id="lifecycle-events">Lifecycle Events</h3>
<ul>
<li><code>ConfigLoaded</code>:- Configuration has been been consolidated, defaults merges with user supplied overrides.</li>
<li><code>PluginsLoaded</code>:- All plugins have been loaded.</li>
<li><code>BeforeSlideChange</code>:- slide about to change.</li>
<li><code>AfterSlideChange</code>:- slide has changed.</li>
<li><code>BeforeModeChange</code>:- Mode is about to change.</li>
<li><code>AfterModeChange</code>:- Mode has changed.</li>
<li>TODO - not all specified yet.</li>
</ul>
<h3 id="runtime-events">Runtime Events</h3>
<ul>
<li><code>LocationChanged</code>:-</li>
<li>effect:- Updates the URL so bookmarking works and slides have unique REST addresses.</li>
<li>fired whenever the <code>suited.state</code> has the current slide number changed.<ul>
<li>usually fired by the builtin plugins such as <code>SlideChangePlugin</code> but also fired when Modes are changed to update the URL</li>
</ul>
</li>
<li><code>SetMode</code>:-</li>
<li>eventdata:- {"modeName": a_mode_name}</li>
<li>effect:- change to named mode</li>
<li><code>NextMode</code>:-</li>
<li>effect:- change to next mode</li>
<li><code>SetModeNum</code>:-</li>
<li>eventdata:- {"modeNum": a_mode_number}</li>
<li>effect:- change to next mode</li>
</ul>
<h4 id="reserved-key-events">Reserved key events</h4>
<p>The <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/core.js"><code>core.js</code></a> listens to browser events such as key presses and clicks for the core features. The handlers simple fire <code>suited</code> events for the builtin plugins to handle. While you can also add a plugin to listen to these <code>suited</code> events should not attempt to change the browser event handlers for these keys.</p>
<h5 id="key-listeners">Key listeners</h5>
<ul>
<li>"left arrow"</li>
<li>fires:-<ul>
<li><code>BeforeSlideChange</code></li>
<li><code>GoBack</code></li>
<li><code>AfterSlideChange</code></li>
</ul>
</li>
<li>effect:- go to previous slide or figure.</li>
<li>"right arrow"</li>
<li>fires:-<ul>
<li><code>BeforeSlideChange</code></li>
<li><code>GoForward</code></li>
<li><code>AfterSlideChange</code></li>
</ul>
</li>
<li>effect:- go to next slide or figure.</li>
<li>"s"</li>
<li>fires:-<ul>
<li><code>NextMode</code></li>
<li><code>LocationChanged</code> passing in current state</li>
</ul>
</li>
<li>effect:- switch to next mode.</li>
<li>"1 -&gt; 9"</li>
<li>fires:-<ul>
<li><code>SetModeNum</code> with eventdata {"modeNum": num}</li>
</ul>
</li>
<li>effect:- change to mode of same number</li>
<li>"SHIFT+t"</li>
<li>fires:-<ul>
<li><code>LocationChanged</code></li>
</ul>
</li>
<li>effect:- go to top of document</li>
<li>"escape key"</li>
<li>fires:-<ul>
<li><code>ESC</code></li>
</ul>
</li>
<li>effect:- jump back to default doc mode.</li>
<li>"enter key"</li>
<li>fires:-<ul>
<li><code>ENTER</code></li>
</ul>
</li>
<li>"any other key press"</li>
<li>fires:-<ul>
<li>"KEY_PRESSED_" + javascript key code</li>
<li>eg KEY_PRESSED_90 key 'z' pressed</li>
</ul>
</li>
</ul>
<h5 id="click-listeners">click listeners</h5>
<ul>
<li>'left mouse click'</li>
<li>fires:-<ul>
<li><code>CLICK</code>:-</li>
<li>eventdata:- the browser click event</li>
<li>effect:- not specified</li>
</ul>
</li>
</ul>
<h5 id="mouse-move-listeners">mouse move listeners</h5>
<ul>
<li>'mouse moved'</li>
<li>effect:- sets the <code>suited.mouseX</code> and <code>suited.mouseY</code> variables</li>
</ul>
<h3 id="plugins">Plugins</h3>
<p>Plugins are the workhorses of <code>suited</code>.
They listen to events and modify the display of the document.</p>
<p>A plugin defines callbacks for events.</p>
<p>Plugins must have a unique <code>name</code> if two have the same name then the second one loaded will replace the first.</p>
<p>Plugins must have a 'registerCallbacks(dispatch)' and a 'deregisterCallbacks(dispatch)' method or function that calls `dispatch.on(eventName, callback)``</p>
<p>It is recomended that you use plugin.js's <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugin.js"><code>new Plugin(name)</code></a> constructor then this will all be taken care of for you.</p>
<p>When Suited adds a plugin it first tests that <code>registerCallbacks</code> adds callbacks and <code>deregisterCallbacks</code>
compleatly removes them before allowing the plugin to be added.</p>
<p>If your plugin uses plugin.js's <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugin.js"><code>new Plugin(name)</code></a> constructor then it will also have the <code>addCallback(eventname, callbackFunc, valueHandler)</code> function, where valueHandler is optional, which can be used to add a callback for an event to a plugin.</p>
<p>A Callback is a <code>function(state, eventData)</code>. <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/state.js"><code>state</code></a> is an object managed by suited and has an <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/state.js"><code>API</code></a></p>
<p>Both state and eventData are optional, but if the callback modifies the state (by using the State API),
then it must return an object that contains the new state,
eg return `{state: someNewState}``</p>
<p>Many callbacks may be called in turn for a particular event, The <code>dispatch</code> makes sure that the state returned is
passed to the next callback.</p>
<p>In addition to returning state, a callback may return a value
eg return {state: somestate, value: calculation }</p>
<p>Normally nothing will be done withthat value, however if you wish to handle It then you
can supply an optional 3rd parameter to Plugin.addCallback(). The 3rd parameter is a "valueHandler'
function. It expects to be passed the callback's return object and can then extract the value and do whatever it needs to do with it.</p>
<h4 id="builtin-plugins">Builtin Plugins</h4>
<ul>
<li><code>LocationManagerPlugin</code></li>
<li>Fixes the URL after a mode or slide change.</li>
<li>listens to:- <code>LocationChanged</code> event.</li>
<li><code>MarkdownPlugin</code></li>
<li>renders markdown in data-markdown elements to HTML</li>
<li>listens to:- <code>PluginsLoaded</code> event.</li>
<li><code>SlideChangePlugin</code></li>
<li>modifies <code>state</code> to reflect the next navigable slide and fires the currentMode's transition function.</li>
<li>listens to:- <code>GoBack</code> and <code>GoForward</code> event.</li>
<li>fires:- <code>LocationChanged</code></li>
<li><a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugins/modes/modePlugin.js"><code>ModePlugin</code></a></li>
<li>responsible for setting the current <code>Mode</code> and setting up a &lt;style&gt; placeholder for Modes to attach custom style to.</li>
<li>listens to:- <code>NextMode</code>, <code>PrevMode</code>, <code>SetMode</code>, <code>SetModeNum</code> and <code>ESC</code></li>
<li>fires:- <code>BeforeModeChange</code>, <code>AfterModeChange</code> to allow modes to setup and teardown and DOM or style changes that they make.</li>
<li>fires:- <code>BeforeSlideChange</code> and <code>AfterSlideChange</code> to allow the Mode to dress the current slide as if it had just been transitioned to rat in the new Mode rhather than simply changing mode.</li>
<li>fires:- <code>ModeCSSFree</code> to let the new mode that the previous modes style placehoder has been cleaned up and it is free to add style if it chooses.</li>
<li>fires <code>LocationChanged</code> in the event of receiving <code>ESC</code> because it not only chnages to default mode but moves the navigation pointer back to the top of the document.</li>
</ul>
<p>Technically the builtin Modes are also plugins but they willl be discussed below.</p>
<h4 id="modes">Modes</h4>
<p><a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugins/modes/mode.js"><code>Mode</code>'s</a> are responsible for the look and feel of the document.</p>
<p>Technically they are plugins and extent from <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugin.js">Plugin</a> but rather than all being loaded/registered with <code>suited</code> only one Mode is loaded at a time by the <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugins/modes/modePlugin.js"><code>ModePlugin</code></a>.</p>
<p>Being plugins, they must have unique names, and their actions are triggered by registering callbacks to the lifecycle events. However they are special special plugins and must also define a transition function that is fired when moving from one slide to the next.</p>
<p>Modes are plugins and can also add callbacks for custom events that they may actually fire themselves in their normal function. For example the <code>lecture</code> mode listens the the default Lifecycle events but also listens to the CLICK event and ENTER upon which it zooms the document.</p>
<p>It is recomended that you you create your own modes using <a href="https://github.com/suited/suited.js/blob/master/src/main/assets/js/plugins/modes/mode.js"><code>new Mode(modeName, fnBeforeSlideChange, fnAfterSlideChange, fnBeforeModeChange, fnAfterModeChange, fnCleanUp, fnShouldShowslide, arrTransitions)</code></a>. all but modeName parameter are optional parameters, but if nothing is supplied it will be a boring Mode.</p>
<p><code>fnBeforeSlideChange</code>, <code>fnAfterSlideChange</code>, <code>fnBeforeModeChange</code>, <code>fnAfterModeChange</code> are plugin callbacks that fire on the lifecycle events <code>BeforeSlideChange</code>, <code>AfterSlideChange</code>, <code>BeforeModeChange</code> and <code>AfterModeChange</code> respectivly. If null then the mode performs no action on those events. Common actions would be changing the style or class of the new and old slides to modify the display or adding extra DOM elements to the document as needed by the mode or its transitions.</p>
<p><code>fnCleanUp</code> should remove and trace that the Mode existed reverting the document to its state before the Mode was applied.</p>
<p><code>fnShouldShowslide</code> is a predicate function that returns true if a slide is to be displayed, if false the navigation will skip it and move to the next. While this could be fancy and run different rules for each slide or consult state to determine if a slide is to display, the default Modes only use it to descriminate between <code>data-figure</code> and <code>data-slide</code> &lt;section&gt;'s'. Most Modes only display the <code>data-figure</code> sections while <code>deck</code> mode is the slide deck and shows both. In this way it is posssible to add slides to the deck that dont show up in the <code>doc</code> view of the document. If this function is null then all are displayed by that mode.</p>
<p><code>arrTransitions</code> is an array of transition objects that the mode supports, with the first one being a default.</p>
<h5 id="mode-transitions">Mode transitions.</h5>
<p>A transition object is used to swap slides, it had functions that handle the swap direction and looks like:-</p>
<pre><code>{
  &quot;name&quot;: &quot;unique_name_in_mode&quot;,
  &quot;top&quot;: function goToTopOfDoc(),
  &quot;left&quot;: function goToPreviousSlide(),
  &quot;right&quot; function goToNextSlide(),
  &quot;up&quot;: function goUpaSlide(),
  &quot;down&quot;: function goDownASlide()
}
</code></pre>

<p>If no transitions are specified then the default "scroll" transition is used.</p>
<p>The transition used is either the Mode's default or the one specified in suited.config for the Mode or one specified by name in the "transition" attribute of a slide section. If a mode supports that named transition and displayed that slide it will use the specified transition whenever it transitions to that slide. eg.</p>
<pre><code>&lt;section data-figure transition=&quot;jump&quot;&gt;
    &lt;img src=&quot;images/jackOfSpades.png&quot; width=&quot;60%&quot; /&gt;
&lt;/section&gt;
</code></pre>

<h5 id="builtin-modes">Builtin Modes</h5>
<ul>
<li><code>doc</code></li>
<li>intent:- display the document as a normal document.</li>
<li>doesn't modify the DOM or style and displays all elements but only data-figure slides.</li>
<li>default "scroll" transition.</li>
<li><code>deck</code></li>
<li>slide deck mode.</li>
<li>displays ONLY the data-figures and data-slides.</li>
<li>intent:- present as aslide show for a talk or meetup.</li>
<li>default "jump" transition</li>
<li><code>walkthrough</code></li>
<li>like doc but add a highlight background to each data-figure as it navigates to it.</li>
<li><code>lecture</code></li>
<li>intent: allow a lecturer to walk through a document discussing it.</li>
<li>like <code>doc</code> but</li>
<li>listens to: "CLICK" event:- zooms the element clicked.</li>
<li>listens to: "ENTER" evnet:- zooms the currently navigated to slide.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>

</body>
</html>
